<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    <style>body { margin: 0; overflow: hidden; }</style>
</head>
<body>
    <script>
        const config = {
            type: Phaser.AUTO,
            width: window.innerWidth,
            height: window.innerHeight,
            physics: { default: 'arcade', arcade: { gravity: { y: 0 }, debug: false } },
            scene: { preload: preload, create: create, update: update }
        };

        const game = new Phaser.Game(config);
        let crew;
        let rooms = [];

        function preload() {
            let g = this.make.graphics();
            // Космонавт
            g.fillStyle(0x00ff00, 1);
            g.fillRect(0, 0, 30, 30);
            g.generateTexture('crew', 30, 30);
            // Комната
            g.clear();
            g.lineStyle(4, 0x555555, 1);
            g.strokeRect(0, 0, 200, 150);
            g.generateTexture('room_border', 200, 150);
        }

        function create() {
            // Создаем 3 отсека: Мостик, Реакторная, Двигатели
            const names = ['МОСТИК', 'РЕАКТОР', 'ДВИГАТЕЛЬ'];
            for(let i = 0; i < 3; i++) {
                let x = 100 + (i * 210);
                let y = 200;
                let roomImg = this.add.image(x, y, 'room_border').setOrigin(0);
                
                let roomData = {
                    name: names[i],
                    x: x, y: y,
                    width: 200, height: 150,
                    hasPower: true,
                    text: this.add.text(x + 10, y + 10, names[i], { fontSize: '16px', color: '#00ff00' })
                };
                rooms.push(roomData);
            }

            // Создаем персонажа (без гравитации для простоты пока)
            crew = this.physics.add.sprite(150, 275, 'crew');
            
            this.input.on('pointerdown', (pointer) => {
                this.physics.moveToObject(crew, pointer, 150);
            });

            this.add.text(20, 20, 'УПРАВЛЕНИЕ: Кликни, чтобы отправить инженера в отсек', { color: '#ffffff' });
        }

        function update() {
            // Проверка: в какой комнате находится инженер?
            rooms.forEach(room => {
                if (crew.x > room.x && crew.x < room.x + room.width &&
                    crew.y > room.y && crew.y < room.y + room.height) {
                    room.text.setText(room.name + "\n[ ИНЖЕНЕР ВНУТРИ ]");
                    room.text.setColor('#ffff00');
                } else {
                    room.text.setText(room.name + (room.hasPower ? "\nСтатус: ОК" : "\nНЕТ ПИТАНИЯ"));
                    room.text.setColor('#00ff00');
                }
            });

            // Остановка возле курсора
            let dist = Phaser.Math.Distance.Between(crew.x, crew.y, this.input.x, this.input.y);
            if (dist < 10) crew.setVelocity(0);
        }
    </script>
</body>
</html>
