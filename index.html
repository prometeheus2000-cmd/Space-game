<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>AI Avatar Console</title>
    <style>
        body { margin: 0; height: 100vh; display: flex; flex-direction: column; justify-content: center; align-items: center; background-color: #0d0d1a; font-family: sans-serif; color: white; }
        .container { position: relative; width: 600px; }
        video { width: 100%; border-radius: 20px; box-shadow: 0 0 30px rgba(0,210,255,0.3); }
        
        .ui-panel { margin-top: 20px; display: flex; gap: 10px; width: 100%; }
        input { flex-grow: 1; padding: 12px; border-radius: 10px; border: none; font-size: 16px; }
        button { padding: 10px 20px; border-radius: 10px; border: none; background: #00d2ff; cursor: pointer; font-weight: bold; }

        .speech-bubble {
            position: absolute; top: 20px; right: -250px; width: 220px;
            background: rgba(255,255,255,0.9); color: #222; padding: 15px;
            border-radius: 15px; font-size: 14px; display: none;
        }
    </style>
</head>
<body>

<div class="container">
    <video id="avatar-video" playsinline>
        <source src="talking_video.mp4" type="video/mp4">
    </video>
    <div id="bubble" class="speech-bubble"></div>
</div>

<div class="ui-panel">
    <input type="text" id="user-input" placeholder="Спроси что-нибудь у ИИ...">
    <button onclick="askAI()">ОТПРАВИТЬ</button>
</div>

<script>
    // 1. ВСТАВЬ СВОЙ КЛЮЧ ТУТ (Бесплатно на https://aistudio.google.com/app/apikey)
    const API_KEY = 'AIzaSyADp1A3iNhSzGkddrwpW4DUV8PjUu72e8M'; 
    
    const video = document.getElementById('avatar-video');
    const bubble = document.getElementById('bubble');
    const input = document.getElementById('user-input');

    async function askAI() {
        const prompt = input.value;
        if (!prompt) return;
        
        input.value = "Думаю...";
        
        try {
            // ШАГ 1: Запрос к мозгу (Gemini)
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            
            const data = await response.json();
            const aiText = data.candidates[0].content.parts[0].text;
            
            speak(aiText);
        } catch (e) {
            alert("Проверь API ключ!");
            input.value = "";
        }
    }

    function speak(text) {
        // ШАГ 2: Голос (Web Speech API)
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'ru-RU'; // Устанавливаем русский голос
        
        // ШАГ 3: Лицо (Видео)
        utterance.onstart = () => {
            video.currentTime = 0;
            video.play();
            bubble.style.display = 'block';
            bubble.innerText = text;
        };

        utterance.onend = () => {
            video.pause(); // Останавливаем, когда договорила
            bubble.style.display = 'none';
            input.value = "";
        };

        window.speechSynthesis.speak(utterance);
    }

    // Позволяет отправлять по нажатию Enter
    input.addEventListener("keypress", (e) => { if (e.key === "Enter") askAI(); });
</script>

</body>
</html>
